<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/trying3/controller/admin/DashboardAdminController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/trying3/controller/admin/DashboardAdminController.java" />
              <option name="originalContent" value="package com.example.trying3.controller.admin;&#10;&#10;import com.example.trying3.MainApplication;&#10;import javafx.fxml.FXML;&#10;import javafx.fxml.FXMLLoader;&#10;import javafx.fxml.Initializable;&#10;import javafx.scene.Node;&#10;import javafx.scene.Parent;&#10;import javafx.scene.Scene;&#10;import javafx.scene.control.Alert;&#10;import javafx.scene.control.ButtonType;&#10;import javafx.scene.control.Label;&#10;import javafx.scene.layout.StackPane;&#10;import javafx.stage.Stage;&#10;&#10;import java.io.IOException;&#10;import java.net.URL;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;import java.util.ResourceBundle;&#10;&#10;public class DashboardAdminController implements Initializable {&#10;&#10;    // FXML Components - Navigation Sidebar&#10;    @FXML private Label btnDashboard;&#10;    @FXML private Label btnKelolaPesanan;&#10;    @FXML private Label btnPembayaran;&#10;    @FXML private Label btnManagementUser;&#10;    @FXML private Label btnNotifikasi;&#10;    @FXML private Label btnLogout;&#10;    @FXML private StackPane contentArea;&#10;&#10;    // Navigation state management&#10;    private final Map&lt;String, Node&gt; panes = new HashMap&lt;&gt;();&#10;    private final Map&lt;String, Object&gt; controllers = new HashMap&lt;&gt;();&#10;    private Node activePane = null;&#10;    private Label activeButton = null;&#10;&#10;    @Override&#10;    public void initialize(URL location, ResourceBundle resource) {&#10;        setupNavigationStyles();&#10;        loadPane(&quot;DashboardPane.fxml&quot;);&#10;        setActiveButton(btnDashboard);&#10;    }&#10;&#10;    /**&#10;     * Mengatur hover effects untuk tombol navigasi sidebar&#10;     */&#10;    private void setupNavigationStyles() {&#10;        Label[] navButtons = {btnDashboard, btnKelolaPesanan, btnPembayaran, btnManagementUser, btnNotifikasi};&#10;        for (Label button : navButtons) {&#10;            if (button != null) {&#10;                button.setOnMouseEntered(e -&gt; {&#10;                    if (button != activeButton) {&#10;                        button.getStyleClass().add(&quot;hover&quot;);&#10;                    }&#10;                });&#10;                button.setOnMouseExited(e -&gt; button.getStyleClass().remove(&quot;hover&quot;));&#10;            }&#10;        }&#10;&#10;        if (btnLogout != null) {&#10;            btnLogout.setOnMouseEntered(e -&gt; btnLogout.getStyleClass().add(&quot;logout-hover&quot;));&#10;            btnLogout.setOnMouseExited(e -&gt; btnLogout.getStyleClass().remove(&quot;logout-hover&quot;));&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Load panel secara dinamis dengan caching untuk performa optimal&#10;     * &#10;     * @param fxmlFile Nama file FXML yang akan dimuat&#10;     */&#10;    private void loadPane(String fxmlFile) {&#10;        try {&#10;            if (activePane != null) {&#10;                activePane.setVisible(false);&#10;            }&#10;&#10;            if (panes.containsKey(fxmlFile)) {&#10;                activePane = panes.get(fxmlFile);&#10;                activePane.setVisible(true);&#10;&#10;                if (&quot;DashboardPane.fxml&quot;.equals(fxmlFile)) {&#10;                    Object controller = controllers.get(fxmlFile);&#10;                    if (controller instanceof DashboardPaneController dashboardController) {&#10;                        dashboardController.refresh();&#10;                    }&#10;                }&#10;            } else {&#10;                String relativePath = &quot;fxml/admin/&quot; + fxmlFile;&#10;                FXMLLoader loader = new FXMLLoader(MainApplication.class.getResource(relativePath));&#10;&#10;                if (loader.getLocation() == null) {&#10;                    throw new IOException(&quot;Cannot find FXML file: &quot; + relativePath);&#10;                }&#10;&#10;                activePane = loader.load();&#10;&#10;                panes.put(fxmlFile, activePane);&#10;                controllers.put(fxmlFile, loader.getController());&#10;                contentArea.getChildren().add(activePane);&#10;            }&#10;        } catch (IOException e) {&#10;            e.printStackTrace();&#10;            showErrorAlert(&quot;Error Memuat Halaman&quot;, &quot;Gagal memuat file: &quot; + fxmlFile, e.getMessage());&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Mengatur tombol navigasi yang sedang aktif&#10;     * &#10;     * @param button Tombol yang akan diset sebagai aktif&#10;     */&#10;    private void setActiveButton(Label button) {&#10;        if (activeButton != null) {&#10;            activeButton.getStyleClass().remove(&quot;active&quot;);&#10;        }&#10;&#10;        activeButton = button;&#10;        if (activeButton != null) {&#10;            activeButton.getStyleClass().add(&quot;active&quot;);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Menampilkan dialog error&#10;     */&#10;    private void showErrorAlert(String title, String header, String content) {&#10;        Alert alert = new Alert(Alert.AlertType.ERROR);&#10;        alert.setTitle(title);&#10;        alert.setHeaderText(header);&#10;        alert.setContentText(content);&#10;        alert.showAndWait();&#10;    }&#10;&#10;    // Navigation event handlers&#10;&#10;    @FXML&#10;    private void handleDashboardClick() {&#10;        loadPane(&quot;DashboardPane.fxml&quot;);&#10;        setActiveButton(btnDashboard);&#10;    }&#10;&#10;    @FXML&#10;    private void handleKelolaPesananClick() {&#10;        loadPane(&quot;KelolaPesananPane.fxml&quot;);&#10;        setActiveButton(btnKelolaPesanan);&#10;    }&#10;&#10;    @FXML&#10;    private void handlePembayaranClick() {&#10;        loadPane(&quot;KelolaPembayaranPane.fxml&quot;);&#10;        setActiveButton(btnPembayaran);&#10;    }&#10;&#10;    @FXML&#10;    private void handleManajemenUserClick() {&#10;        loadPane(&quot;ManajemenUserPane.fxml&quot;);&#10;        setActiveButton(btnManagementUser);&#10;    }&#10;&#10;    @FXML&#10;    private void handleNotifikasiClick() {&#10;        loadPane(&quot;NotifikasiPane.fxml&quot;);&#10;        setActiveButton(btnNotifikasi);&#10;    }&#10;&#10;    @FXML&#10;    private void handleLogoutClick() {&#10;        Alert alert = new Alert(Alert.AlertType.CONFIRMATION, &quot;Yakin ingin logout?&quot;, ButtonType.YES, ButtonType.NO);&#10;        alert.setTitle(&quot;Konfirmasi Logout&quot;);&#10;        alert.setHeaderText(null);&#10;        alert.showAndWait().ifPresent(response -&gt; {&#10;            if (response == ButtonType.YES) {&#10;                try {&#10;                    URL loginResource = MainApplication.class.getResource(&quot;fxml/auth/Login.fxml&quot;);&#10;                    FXMLLoader loader = new FXMLLoader(loginResource);&#10;                    Parent root = loader.load();&#10;&#10;                    Stage stage = (Stage) btnLogout.getScene().getWindow();&#10;&#10;                    Scene scene = new Scene(root);&#10;                    stage.setScene(scene);&#10;&#10;                    stage.centerOnScreen();&#10;                    stage.show();&#10;                } catch (IOException e) {&#10;                    e.printStackTrace();&#10;                    System.err.println(&quot;Gagal memuat halaman login: &quot; + e.getMessage());&#10;                }&#10;            }&#10;        });&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.trying3.controller.admin;&#10;&#10;import com.example.trying3.MainApplication;&#10;import javafx.fxml.FXML;&#10;import javafx.fxml.FXMLLoader;&#10;import javafx.fxml.Initializable;&#10;import javafx.scene.Node;&#10;import javafx.scene.Parent;&#10;import javafx.scene.Scene;&#10;import javafx.scene.control.Alert;&#10;import javafx.scene.control.ButtonType;&#10;import javafx.scene.control.Label;&#10;import javafx.scene.layout.StackPane;&#10;import javafx.stage.Stage;&#10;&#10;import java.io.IOException;&#10;import java.net.URL;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;import java.util.ResourceBundle;&#10;&#10;public class DashboardAdminController implements Initializable {&#10;&#10;    // FXML Components - Navigation Sidebar&#10;    @FXML private Label btnDashboard;&#10;    @FXML private Label btnKelolaPesanan;&#10;    @FXML private Label btnPembayaran;&#10;    @FXML private Label btnManagementUser;&#10;    @FXML private Label btnNotifikasi;&#10;    @FXML private Label btnLogout;&#10;    @FXML private StackPane contentArea;&#10;&#10;    // Navigation state management&#10;    private final Map&lt;String, Node&gt; panes = new HashMap&lt;&gt;();&#10;    private final Map&lt;String, Object&gt; controllers = new HashMap&lt;&gt;();&#10;    private Node activePane = null;&#10;    private Label activeButton = null;&#10;&#10;    @Override&#10;    public void initialize(URL location, ResourceBundle resource) {&#10;        setupNavigationStyles();&#10;        loadPane(&quot;DashboardPane.fxml&quot;);&#10;        setActiveButton(btnDashboard);&#10;    }&#10;&#10;    /**&#10;     * Mengatur hover effects untuk tombol navigasi sidebar&#10;     */&#10;    private void setupNavigationStyles() {&#10;        Label[] navButtons = {btnDashboard, btnKelolaPesanan, btnPembayaran, btnManagementUser, btnNotifikasi};&#10;        for (Label button : navButtons) {&#10;            if (button != null) {&#10;                button.setOnMouseEntered(e -&gt; {&#10;                    if (button != activeButton) {&#10;                        button.getStyleClass().add(&quot;hover&quot;);&#10;                    }&#10;                });&#10;                button.setOnMouseExited(e -&gt; button.getStyleClass().remove(&quot;hover&quot;));&#10;            }&#10;        }&#10;&#10;        if (btnLogout != null) {&#10;            btnLogout.setOnMouseEntered(e -&gt; btnLogout.getStyleClass().add(&quot;logout-hover&quot;));&#10;            btnLogout.setOnMouseExited(e -&gt; btnLogout.getStyleClass().remove(&quot;logout-hover&quot;));&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Load panel secara dinamis dengan caching untuk performa optimal&#10;     * &#10;     * @param fxmlFile Nama file FXML yang akan dimuat&#10;     */&#10;    private void loadPane(String fxmlFile) {&#10;        try {&#10;            if (activePane != null) {&#10;                activePane.setVisible(false);&#10;            }&#10;&#10;            if (panes.containsKey(fxmlFile)) {&#10;                activePane = panes.get(fxmlFile);&#10;                activePane.setVisible(true);&#10;&#10;                if (&quot;DashboardPane.fxml&quot;.equals(fxmlFile)) {&#10;                    Object controller = controllers.get(fxmlFile);&#10;                    if (controller instanceof DashboardPaneController dashboardController) {&#10;                        dashboardController.refresh();&#10;                    }&#10;                }&#10;            } else {&#10;                String relativePath = &quot;fxml/admin/&quot; + fxmlFile;&#10;                FXMLLoader loader = new FXMLLoader(MainApplication.class.getResource(relativePath));&#10;&#10;                if (loader.getLocation() == null) {&#10;                    throw new IOException(&quot;Cannot find FXML file: &quot; + relativePath);&#10;                }&#10;&#10;                activePane = loader.load();&#10;&#10;                panes.put(fxmlFile, activePane);&#10;                controllers.put(fxmlFile, loader.getController());&#10;                contentArea.getChildren().add(activePane);&#10;            }&#10;        } catch (IOException e) {&#10;            e.printStackTrace();&#10;            showErrorAlert(&quot;Error Memuat Halaman&quot;, &quot;Gagal memuat file: &quot; + fxmlFile, e.getMessage());&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Mengatur tombol navigasi yang sedang aktif&#10;     * &#10;     * @param button Tombol yang akan diset sebagai aktif&#10;     */&#10;    private void setActiveButton(Label button) {&#10;        if (activeButton != null) {&#10;            activeButton.getStyleClass().remove(&quot;active&quot;);&#10;        }&#10;&#10;        activeButton = button;&#10;        if (activeButton != null) {&#10;            activeButton.getStyleClass().add(&quot;active&quot;);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Menampilkan dialog error&#10;     */&#10;    private void showErrorAlert(String title, String header, String content) {&#10;        Alert alert = new Alert(Alert.AlertType.ERROR);&#10;        alert.setTitle(title);&#10;        alert.setHeaderText(header);&#10;        alert.setContentText(content);&#10;        alert.showAndWait();&#10;    }&#10;&#10;    // Navigation event handlers&#10;&#10;    @FXML&#10;    private void handleDashboardClick() {&#10;        loadPane(&quot;DashboardPane.fxml&quot;);&#10;        setActiveButton(btnDashboard);&#10;    }&#10;&#10;    @FXML&#10;    private void handleKelolaPesananClick() {&#10;        loadPane(&quot;KelolaPesananPane.fxml&quot;);&#10;        setActiveButton(btnKelolaPesanan);&#10;    }&#10;&#10;    @FXML&#10;    private void handlePembayaranClick() {&#10;        loadPane(&quot;KelolaPembayaranPane.fxml&quot;);&#10;        setActiveButton(btnPembayaran);&#10;    }&#10;&#10;    @FXML&#10;    private void handleManajemenUserClick() {&#10;        loadPane(&quot;ManajemenUserPane.fxml&quot;);&#10;        setActiveButton(btnManagementUser);&#10;    }&#10;&#10;    @FXML&#10;    private void handleNotifikasiClick() {&#10;        loadPane(&quot;NotifikasiPane.fxml&quot;);&#10;        setActiveButton(btnNotifikasi);&#10;    }&#10;&#10;    @FXML&#10;    private void handleLogoutClick() {&#10;        Alert alert = new Alert(Alert.AlertType.CONFIRMATION, &quot;Yakin ingin logout?&quot;, ButtonType.YES, ButtonType.NO);&#10;        alert.setTitle(&quot;Konfirmasi Logout&quot;);&#10;        alert.setHeaderText(null);&#10;        alert.showAndWait().ifPresent(response -&gt; {&#10;            if (response == ButtonType.YES) {&#10;                try {&#10;                    URL loginResource = MainApplication.class.getResource(&quot;fxml/auth/Login.fxml&quot;);&#10;                    FXMLLoader loader = new FXMLLoader(loginResource);&#10;                    Parent root = loader.load();&#10;&#10;                    Stage stage = (Stage) btnLogout.getScene().getWindow();&#10;&#10;                    Scene scene = new Scene(root);&#10;                    stage.setScene(scene);&#10;&#10;                    stage.centerOnScreen();&#10;                    stage.show();&#10;                } catch (IOException e) {&#10;                    e.printStackTrace();&#10;                    System.err.println(&quot;Gagal memuat halaman login: &quot; + e.getMessage());&#10;                }&#10;            }&#10;        });&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/trying3/controller/admin/DashboardPaneController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/trying3/controller/admin/DashboardPaneController.java" />
              <option name="originalContent" value="package com.example.trying3.controller.admin;&#10;&#10;import com.example.trying3.dao.DashboardStatsDAO;&#10;import com.example.trying3.model.Pesanan;&#10;import com.example.trying3.model.User;&#10;import javafx.application.Platform;&#10;import javafx.collections.FXCollections;&#10;import javafx.collections.ObservableList;&#10;import javafx.concurrent.Task;&#10;import javafx.fxml.FXML;&#10;import javafx.fxml.Initializable;&#10;import javafx.scene.control.Label;&#10;import javafx.scene.control.ListView;&#10;&#10;import java.net.URL;&#10;import java.util.List;&#10;import java.util.ResourceBundle;&#10;&#10;public class DashboardPaneController implements Initializable {&#10;&#10;    // FXML Components - Statistics Labels&#10;    @FXML private Label totalPesananLabel;&#10;    @FXML private Label totalPesananSubtitle;&#10;    @FXML private Label pesananSelesaiLabel;&#10;    @FXML private Label pesananSelesaiSubtitle;&#10;    @FXML private Label pembayaranPendingLabel;&#10;    @FXML private Label pembayaranPendingSubtitle;&#10;    @FXML private Label totalPendapatanLabel;&#10;    @FXML private Label totalPendapatanSubtitle;&#10;&#10;    // FXML Components - List Views&#10;    @FXML private ListView&lt;Pesanan&gt; pesananTerbaruListView;&#10;    @FXML private ListView&lt;User&gt; aktivitasUserListView;&#10;&#10;    // Data sources&#10;    private DashboardStatsDAO dashboardDAO;&#10;    private final ObservableList&lt;Pesanan&gt; pesananList = FXCollections.observableArrayList();&#10;    private final ObservableList&lt;User&gt; userList = FXCollections.observableArrayList();&#10;&#10;    @Override&#10;    public void initialize(URL location, ResourceBundle resources) {&#10;        dashboardDAO = new DashboardStatsDAO();&#10;        setupPesananListView();&#10;        setupUserListView();&#10;        loadAllData();&#10;    }&#10;&#10;    /**&#10;     * Konfigurasi ListView untuk pesanan terbaru dengan custom cell&#10;     */&#10;    private void setupPesananListView() {&#10;        if (pesananTerbaruListView != null) {&#10;            pesananTerbaruListView.setItems(pesananList);&#10;            pesananTerbaruListView.setCellFactory(lv -&gt; new PesananTerbaruCell());&#10;            pesananTerbaruListView.setFixedCellSize(70);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Konfigurasi ListView untuk aktivitas user dengan custom cell&#10;     */&#10;    private void setupUserListView() {&#10;        if (aktivitasUserListView != null) {&#10;            aktivitasUserListView.setItems(userList);&#10;            aktivitasUserListView.setCellFactory(lv -&gt; new UserAktivitasCell());&#10;            aktivitasUserListView.setFixedCellSize(70);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Load semua data dashboard secara asynchronous&#10;     */&#10;    public void loadAllData() {&#10;        loadStatistics();&#10;        loadPesananTerbaru();&#10;        loadAktivitasUser();&#10;    }&#10;&#10;    /**&#10;     * Memuat statistik dashboard dari database&#10;     * Data: Total Pesanan, Pesanan Selesai, Pembayaran Pending, Total Pendapatan&#10;     */&#10;    private void loadStatistics() {&#10;        Task&lt;Void&gt; statsTask = new Task&lt;&gt;() {&#10;            private int totalPesanan;&#10;            private int pesananSelesai;&#10;            private String persenSelesai;&#10;            private int pembayaranPending;&#10;            private String totalPendapatan;&#10;&#10;            @Override&#10;            protected Void call() {&#10;                totalPesanan = dashboardDAO.getTotalPesanan();&#10;                pesananSelesai = dashboardDAO.getPesananSelesai();&#10;                persenSelesai = dashboardDAO.getPersentasePesananSelesai();&#10;                pembayaranPending = dashboardDAO.getPembayaranPending();&#10;                totalPendapatan = dashboardDAO.getFormattedTotalPendapatan();&#10;                return null;&#10;            }&#10;&#10;            @Override&#10;            protected void succeeded() {&#10;                Platform.runLater(() -&gt; {&#10;                    if (totalPesananLabel != null) {&#10;                        totalPesananLabel.setText(String.valueOf(totalPesanan));&#10;                    }&#10;                    if (totalPesananSubtitle != null) {&#10;                        totalPesananSubtitle.setText(&quot;Semua pesanan&quot;);&#10;                    }&#10;&#10;                    if (pesananSelesaiLabel != null) {&#10;                        pesananSelesaiLabel.setText(String.valueOf(pesananSelesai));&#10;                    }&#10;                    if (pesananSelesaiSubtitle != null) {&#10;                        pesananSelesaiSubtitle.setText(persenSelesai);&#10;                    }&#10;&#10;                    if (pembayaranPendingLabel != null) {&#10;                        pembayaranPendingLabel.setText(String.valueOf(pembayaranPending));&#10;                    }&#10;                    if (pembayaranPendingSubtitle != null) {&#10;                        pembayaranPendingSubtitle.setText(&quot;Perlu verifikasi&quot;);&#10;                    }&#10;&#10;                    if (totalPendapatanLabel != null) {&#10;                        totalPendapatanLabel.setText(totalPendapatan);&#10;                    }&#10;                    if (totalPendapatanSubtitle != null) {&#10;                        totalPendapatanSubtitle.setText(&quot;Pembayaran terverifikasi&quot;);&#10;                    }&#10;                });&#10;            }&#10;&#10;            @Override&#10;            protected void failed() {&#10;                getException().printStackTrace();&#10;                Platform.runLater(() -&gt; {&#10;                    if (totalPesananLabel != null) totalPesananLabel.setText(&quot;0&quot;);&#10;                    if (pesananSelesaiLabel != null) pesananSelesaiLabel.setText(&quot;0&quot;);&#10;                    if (pembayaranPendingLabel != null) pembayaranPendingLabel.setText(&quot;0&quot;);&#10;                    if (totalPendapatanLabel != null) totalPendapatanLabel.setText(&quot;Rp 0&quot;);&#10;                });&#10;            }&#10;        };&#10;&#10;        new Thread(statsTask).start();&#10;    }&#10;&#10;    /**&#10;     * Memuat 5 pesanan terbaru dari database&#10;     */&#10;    private void loadPesananTerbaru() {&#10;        Task&lt;List&lt;Pesanan&gt;&gt; task = new Task&lt;&gt;() {&#10;            @Override&#10;            protected List&lt;Pesanan&gt; call() {&#10;                return dashboardDAO.getPesananTerbaru(5);&#10;            }&#10;        };&#10;&#10;        task.setOnSucceeded(e -&gt; Platform.runLater(() -&gt; {&#10;            pesananList.clear();&#10;            pesananList.addAll(task.getValue());&#10;        }));&#10;&#10;        task.setOnFailed(e -&gt; task.getException().printStackTrace());&#10;&#10;        new Thread(task).start();&#10;    }&#10;&#10;    /**&#10;     * Memuat daftar user aktif dari database&#10;     */&#10;    private void loadAktivitasUser() {&#10;        Task&lt;List&lt;User&gt;&gt; task = new Task&lt;&gt;() {&#10;            @Override&#10;            protected List&lt;User&gt; call() {&#10;                return dashboardDAO.getActiveUsers();&#10;            }&#10;        };&#10;&#10;        task.setOnSucceeded(e -&gt; Platform.runLater(() -&gt; {&#10;            userList.clear();&#10;            userList.addAll(task.getValue());&#10;        }));&#10;&#10;        task.setOnFailed(e -&gt; task.getException().printStackTrace());&#10;&#10;        new Thread(task).start();&#10;    }&#10;&#10;    /**&#10;     * Refresh semua data dashboard&#10;     * Dipanggil dari DashboardAdminController saat navigasi ke halaman ini&#10;     */&#10;    public void refresh() {&#10;        loadAllData();&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.trying3.controller.admin;&#10;&#10;import com.example.trying3.dao.DashboardStatsDAO;&#10;import com.example.trying3.model.Pesanan;&#10;import com.example.trying3.model.User;&#10;import javafx.application.Platform;&#10;import javafx.collections.FXCollections;&#10;import javafx.collections.ObservableList;&#10;import javafx.concurrent.Task;&#10;import javafx.fxml.FXML;&#10;import javafx.fxml.Initializable;&#10;import javafx.scene.control.Label;&#10;import javafx.scene.control.ListView;&#10;&#10;import java.net.URL;&#10;import java.util.List;&#10;import java.util.ResourceBundle;&#10;&#10;public class DashboardPaneController implements Initializable {&#10;&#10;    // FXML Components - Statistics Labels&#10;    @FXML private Label totalPesananLabel;&#10;    @FXML private Label totalPesananSubtitle;&#10;    @FXML private Label pesananSelesaiLabel;&#10;    @FXML private Label pesananSelesaiSubtitle;&#10;    @FXML private Label pembayaranPendingLabel;&#10;    @FXML private Label pembayaranPendingSubtitle;&#10;    @FXML private Label totalPendapatanLabel;&#10;    @FXML private Label totalPendapatanSubtitle;&#10;&#10;    // FXML Components - List Views&#10;    @FXML private ListView&lt;Pesanan&gt; pesananTerbaruListView;&#10;    @FXML private ListView&lt;User&gt; aktivitasUserListView;&#10;&#10;    // Data sources&#10;    private DashboardStatsDAO dashboardDAO;&#10;    private final ObservableList&lt;Pesanan&gt; pesananList = FXCollections.observableArrayList();&#10;    private final ObservableList&lt;User&gt; userList = FXCollections.observableArrayList();&#10;&#10;    @Override&#10;    public void initialize(URL location, ResourceBundle resources) {&#10;        dashboardDAO = new DashboardStatsDAO();&#10;        setupPesananListView();&#10;        setupUserListView();&#10;        loadAllData();&#10;    }&#10;&#10;    /**&#10;     * Konfigurasi ListView untuk pesanan terbaru dengan custom cell&#10;     */&#10;    private void setupPesananListView() {&#10;        if (pesananTerbaruListView != null) {&#10;            pesananTerbaruListView.setItems(pesananList);&#10;            pesananTerbaruListView.setCellFactory(lv -&gt; new PesananTerbaruCell());&#10;            pesananTerbaruListView.setFixedCellSize(70);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Konfigurasi ListView untuk aktivitas user dengan custom cell&#10;     */&#10;    private void setupUserListView() {&#10;        if (aktivitasUserListView != null) {&#10;            aktivitasUserListView.setItems(userList);&#10;            aktivitasUserListView.setCellFactory(lv -&gt; new UserAktivitasCell());&#10;            aktivitasUserListView.setFixedCellSize(70);&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Load semua data dashboard secara asynchronous&#10;     */&#10;    public void loadAllData() {&#10;        loadStatistics();&#10;        loadPesananTerbaru();&#10;        loadAktivitasUser();&#10;    }&#10;&#10;    /**&#10;     * Memuat statistik dashboard dari database&#10;     * Data: Total Pesanan, Pesanan Selesai, Pembayaran Pending, Total Pendapatan&#10;     */&#10;    private void loadStatistics() {&#10;        Task&lt;Void&gt; statsTask = new Task&lt;&gt;() {&#10;            private int totalPesanan;&#10;            private int pesananSelesai;&#10;            private String persenSelesai;&#10;            private int pembayaranPending;&#10;            private String totalPendapatan;&#10;&#10;            @Override&#10;            protected Void call() {&#10;                totalPesanan = dashboardDAO.getTotalPesanan();&#10;                pesananSelesai = dashboardDAO.getPesananSelesai();&#10;                persenSelesai = dashboardDAO.getPersentasePesananSelesai();&#10;                pembayaranPending = dashboardDAO.getPembayaranPending();&#10;                totalPendapatan = dashboardDAO.getFormattedTotalPendapatan();&#10;                return null;&#10;            }&#10;&#10;            @Override&#10;            protected void succeeded() {&#10;                Platform.runLater(() -&gt; {&#10;                    if (totalPesananLabel != null) {&#10;                        totalPesananLabel.setText(String.valueOf(totalPesanan));&#10;                    }&#10;                    if (totalPesananSubtitle != null) {&#10;                        totalPesananSubtitle.setText(&quot;Semua pesanan&quot;);&#10;                    }&#10;&#10;                    if (pesananSelesaiLabel != null) {&#10;                        pesananSelesaiLabel.setText(String.valueOf(pesananSelesai));&#10;                    }&#10;                    if (pesananSelesaiSubtitle != null) {&#10;                        pesananSelesaiSubtitle.setText(persenSelesai);&#10;                    }&#10;&#10;                    if (pembayaranPendingLabel != null) {&#10;                        pembayaranPendingLabel.setText(String.valueOf(pembayaranPending));&#10;                    }&#10;                    if (pembayaranPendingSubtitle != null) {&#10;                        pembayaranPendingSubtitle.setText(&quot;Perlu verifikasi&quot;);&#10;                    }&#10;&#10;                    if (totalPendapatanLabel != null) {&#10;                        totalPendapatanLabel.setText(totalPendapatan);&#10;                    }&#10;                    if (totalPendapatanSubtitle != null) {&#10;                        totalPendapatanSubtitle.setText(&quot;Pembayaran terverifikasi&quot;);&#10;                    }&#10;                });&#10;            }&#10;&#10;            @Override&#10;            protected void failed() {&#10;                getException().printStackTrace();&#10;                Platform.runLater(() -&gt; {&#10;                    if (totalPesananLabel != null) totalPesananLabel.setText(&quot;0&quot;);&#10;                    if (pesananSelesaiLabel != null) pesananSelesaiLabel.setText(&quot;0&quot;);&#10;                    if (pembayaranPendingLabel != null) pembayaranPendingLabel.setText(&quot;0&quot;);&#10;                    if (totalPendapatanLabel != null) totalPendapatanLabel.setText(&quot;Rp 0&quot;);&#10;                });&#10;            }&#10;        };&#10;&#10;        new Thread(statsTask).start();&#10;    }&#10;&#10;    /**&#10;     * Memuat 5 pesanan terbaru dari database&#10;     */&#10;    private void loadPesananTerbaru() {&#10;        Task&lt;List&lt;Pesanan&gt;&gt; task = new Task&lt;&gt;() {&#10;            @Override&#10;            protected List&lt;Pesanan&gt; call() {&#10;                return dashboardDAO.getPesananTerbaru(5);&#10;            }&#10;        };&#10;&#10;        task.setOnSucceeded(e -&gt; Platform.runLater(() -&gt; {&#10;            pesananList.clear();&#10;            pesananList.addAll(task.getValue());&#10;        }));&#10;&#10;        task.setOnFailed(e -&gt; task.getException().printStackTrace());&#10;&#10;        new Thread(task).start();&#10;    }&#10;&#10;    /**&#10;     * Memuat daftar user aktif dari database&#10;     */&#10;    private void loadAktivitasUser() {&#10;        Task&lt;List&lt;User&gt;&gt; task = new Task&lt;&gt;() {&#10;            @Override&#10;            protected List&lt;User&gt; call() {&#10;                return dashboardDAO.getActiveUsers();&#10;            }&#10;        };&#10;&#10;        task.setOnSucceeded(e -&gt; Platform.runLater(() -&gt; {&#10;            userList.clear();&#10;            userList.addAll(task.getValue());&#10;        }));&#10;&#10;        task.setOnFailed(e -&gt; task.getException().printStackTrace());&#10;&#10;        new Thread(task).start();&#10;    }&#10;&#10;    /**&#10;     * Refresh semua data dashboard&#10;     * Dipanggil dari DashboardAdminController saat navigasi ke halaman ini&#10;     */&#10;    public void refresh() {&#10;        loadAllData();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/trying3/dao/DashboardStatsDAO.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/trying3/dao/DashboardStatsDAO.java" />
              <option name="originalContent" value="package com.example.trying3.dao;&#10;&#10;import com.example.trying3.config.DatabaseConnection;&#10;import com.example.trying3.model.Pesanan;&#10;import com.example.trying3.model.User;&#10;&#10;import java.sql.*;&#10;import java.text.NumberFormat;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;import java.util.Locale;&#10;&#10;/**&#10; * Data Access Object untuk statistik Dashboard.&#10; * Menyediakan berbagai metrik dan data untuk dashboard admin.&#10; */&#10;public class DashboardStatsDAO {&#10;&#10;    public int getTotalPesanan() {&#10;        String sql = &quot;SELECT COUNT(*) FROM pesanan&quot;;&#10;        return executeCountQuery(sql);&#10;    }&#10;&#10;    public int getPesananSelesai() {&#10;        String sql = &quot;&quot;&quot;&#10;            SELECT COUNT(*) FROM pesanan p&#10;            JOIN status_pesanan sp ON p.id_status = sp.id_status&#10;            WHERE sp.nama_status = 'Selesai'&#10;        &quot;&quot;&quot;;&#10;        return executeCountQuery(sql);&#10;    }&#10;&#10;    public String getPersentasePesananSelesai() {&#10;        int total = getTotalPesanan();&#10;        int selesai = getPesananSelesai();&#10;        if (total == 0) return &quot;0%&quot;;&#10;        int persen = (selesai * 100) / total;&#10;        return persen + &quot;% dari total&quot;;&#10;    }&#10;&#10;    public int getPembayaranPending() {&#10;        String sql = &quot;&quot;&quot;&#10;            SELECT COUNT(*) FROM pesanan p&#10;            JOIN status_pesanan sp ON p.id_status = sp.id_status&#10;            WHERE sp.nama_status = 'Menunggu Pembayaran'&#10;        &quot;&quot;&quot;;&#10;        return executeCountQuery(sql);&#10;    }&#10;&#10;    public double getTotalPendapatan() {&#10;        String sql = &quot;SELECT COALESCE(SUM(jumlah), 0) FROM pembayaran WHERE status_pembayaran = 'verified'&quot;;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#10;             ResultSet rs = ps.executeQuery()) {&#10;            if (rs.next()) {&#10;                return rs.getDouble(1);&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return 0;&#10;    }&#10;&#10;    public String getFormattedTotalPendapatan() {&#10;        double total = getTotalPendapatan();&#10;        NumberFormat formatter = NumberFormat.getCurrencyInstance(new Locale(&quot;id&quot;, &quot;ID&quot;));&#10;        String formatted = formatter.format(total);&#10;        return formatted.replace(&quot;,00&quot;, &quot;&quot;).replace(&quot;Rp&quot;, &quot;Rp &quot;);&#10;    }&#10;&#10;    public static class DashboardStats {&#10;        public int pesananHariIni;&#10;        public int pesananMingguIni;&#10;        public int pesananSelesai;&#10;        public int pembayaranPending;&#10;        public double pendapatanBulanIni;&#10;        public int produksiBerjalan;&#10;        public int kendalaAktif;&#10;    }&#10;&#10;    /**&#10;     * Mengambil semua statistik sekaligus dari view v_dashboard_stats&#10;     */&#10;    public DashboardStats getAllStats() {&#10;        String sql = &quot;SELECT * FROM v_dashboard_stats&quot;;&#10;        DashboardStats stats = new DashboardStats();&#10;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#10;             ResultSet rs = ps.executeQuery()) {&#10;&#10;            if (rs.next()) {&#10;                stats.pesananHariIni = rs.getInt(&quot;pesanan_hari_ini&quot;);&#10;                stats.pesananMingguIni = rs.getInt(&quot;pesanan_minggu_ini&quot;);&#10;                stats.pesananSelesai = rs.getInt(&quot;pesanan_selesai&quot;);&#10;                stats.pembayaranPending = rs.getInt(&quot;pembayaran_pending&quot;);&#10;                stats.pendapatanBulanIni = rs.getDouble(&quot;pendapatan_bulan_ini&quot;);&#10;                stats.produksiBerjalan = rs.getInt(&quot;produksi_berjalan&quot;);&#10;                stats.kendalaAktif = rs.getInt(&quot;kendala_aktif&quot;);&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return stats;&#10;    }&#10;&#10;    // Pesanan Terbaru&#10;&#10;    /**&#10;     * Mengambil pesanan terbaru dengan limit tertentu&#10;     * Data sudah di-join dengan pelanggan, status, dan detail pesanan&#10;     */&#10;    public List&lt;Pesanan&gt; getPesananTerbaru(int limit) {&#10;        List&lt;Pesanan&gt; list = new ArrayList&lt;&gt;();&#10;        String sql = &quot;&quot;&quot;&#10;            SELECT &#10;                p.id_pesanan,&#10;                p.nomor_pesanan,&#10;                pl.nama AS nama_pelanggan,&#10;                pl.no_telepon,&#10;                pl.email,&#10;                jl.nama_layanan,&#10;                dp.jumlah,&#10;                p.total_biaya AS total_harga,&#10;                dp.spesifikasi,&#10;                sp.nama_status AS status,&#10;                p.tanggal_pesanan,&#10;                p.updated_at,&#10;                p.catatan&#10;            FROM pesanan p&#10;            JOIN pelanggan pl ON p.id_pelanggan = pl.id_pelanggan&#10;            JOIN status_pesanan sp ON p.id_status = sp.id_status&#10;            LEFT JOIN detail_pesanan dp ON p.id_pesanan = dp.id_pesanan&#10;            LEFT JOIN jenis_layanan jl ON dp.id_layanan = jl.id_layanan&#10;            ORDER BY p.tanggal_pesanan DESC&#10;            LIMIT ?&#10;        &quot;&quot;&quot;;&#10;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             PreparedStatement ps = conn.prepareStatement(sql)) {&#10;&#10;            ps.setInt(1, limit);&#10;&#10;            try (ResultSet rs = ps.executeQuery()) {&#10;                while (rs.next()) {&#10;                    Pesanan pesanan = mapResultSetToPesanan(rs);&#10;                    list.add(pesanan);&#10;                }&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return list;&#10;    }&#10;&#10;&#10;    // Aktivitas User Terbaru&#10;&#10;    /**&#10;     * Mengambil daftar user aktif dengan role-nya&#10;     * Untuk ditampilkan di section &quot;Aktivitas User&quot;&#10;     */&#10;    public List&lt;User&gt; getActiveUsers() {&#10;        List&lt;User&gt; list = new ArrayList&lt;&gt;();&#10;        String sql = &quot;&quot;&quot;&#10;            SELECT &#10;                u.id_user,&#10;                u.username,&#10;                u.nama_lengkap,&#10;                u.email,&#10;                u.id_role,&#10;                r.nama_role,&#10;                u.is_active,&#10;                u.last_login,&#10;                u.created_at,&#10;                u.updated_at&#10;            FROM user u&#10;            JOIN role r ON u.id_role = r.id_role&#10;            WHERE u.is_active = 1&#10;            ORDER BY u.last_login DESC&#10;        &quot;&quot;&quot;;&#10;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#10;             ResultSet rs = ps.executeQuery()) {&#10;&#10;            while (rs.next()) {&#10;                User user = new User();&#10;                user.setIdUser(rs.getInt(&quot;id_user&quot;));&#10;                user.setUsername(rs.getString(&quot;username&quot;));&#10;                user.setNamaLengkap(rs.getString(&quot;nama_lengkap&quot;));&#10;                user.setEmail(rs.getString(&quot;email&quot;));&#10;                user.setIdRole(rs.getInt(&quot;id_role&quot;));&#10;                user.setActive(rs.getBoolean(&quot;is_active&quot;));&#10;&#10;                Timestamp lastLogin = rs.getTimestamp(&quot;last_login&quot;);&#10;                if (lastLogin != null) {&#10;                    user.setLastLogin(lastLogin.toLocalDateTime());&#10;                }&#10;&#10;                Timestamp createdAt = rs.getTimestamp(&quot;created_at&quot;);&#10;                if (createdAt != null) {&#10;                    user.setCreatedAt(createdAt.toLocalDateTime());&#10;                }&#10;&#10;                list.add(user);&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return list;&#10;    }&#10;&#10;    /**&#10;     * Mendapatkan nama role berdasarkan id_role&#10;     */&#10;    public String getRoleName(int idRole) {&#10;        String sql = &quot;SELECT nama_role FROM role WHERE id_role = ?&quot;;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             PreparedStatement ps = conn.prepareStatement(sql)) {&#10;            ps.setInt(1, idRole);&#10;            try (ResultSet rs = ps.executeQuery()) {&#10;                if (rs.next()) {&#10;                    return rs.getString(&quot;nama_role&quot;);&#10;                }&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return &quot;Unknown&quot;;&#10;    }&#10;&#10;    // Helper Methods&#10;&#10;    /**&#10;     * Helper untuk menjalankan query COUNT&#10;     */&#10;    private int executeCountQuery(String sql) {&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#10;             ResultSet rs = ps.executeQuery()) {&#10;            if (rs.next()) {&#10;                return rs.getInt(1);&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return 0;&#10;    }&#10;&#10;    /**&#10;     * Mapping ResultSet ke object Pesanan&#10;     */&#10;    private Pesanan mapResultSetToPesanan(ResultSet rs) throws SQLException {&#10;        Pesanan pesanan = new Pesanan();&#10;        pesanan.setIdPesanan(rs.getInt(&quot;id_pesanan&quot;));&#10;        pesanan.setNomorPesanan(rs.getString(&quot;nomor_pesanan&quot;));&#10;        pesanan.setNamaPelanggan(rs.getString(&quot;nama_pelanggan&quot;));&#10;&#10;        try { pesanan.setNoTelepon(rs.getString(&quot;no_telepon&quot;)); } catch (SQLException ignored) {}&#10;        try { pesanan.setEmail(rs.getString(&quot;email&quot;)); } catch (SQLException ignored) {}&#10;&#10;        pesanan.setJenisLayanan(rs.getString(&quot;nama_layanan&quot;));&#10;        pesanan.setJumlah(rs.getInt(&quot;jumlah&quot;));&#10;        pesanan.setTotalBiaya(rs.getDouble(&quot;total_harga&quot;));&#10;&#10;        try { pesanan.setSpesifikasi(rs.getString(&quot;spesifikasi&quot;)); } catch (SQLException ignored) {}&#10;&#10;        pesanan.setStatus(rs.getString(&quot;status&quot;));&#10;&#10;        try { pesanan.setCatatan(rs.getString(&quot;catatan&quot;)); } catch (SQLException ignored) {}&#10;&#10;        Timestamp tanggalTs = rs.getTimestamp(&quot;tanggal_pesanan&quot;);&#10;        if (tanggalTs != null) {&#10;            pesanan.setTanggalPesanan(tanggalTs.toLocalDateTime());&#10;        }&#10;&#10;        try {&#10;            Timestamp updatedTs = rs.getTimestamp(&quot;updated_at&quot;);&#10;            if (updatedTs != null) {&#10;                pesanan.setUpdatedAt(updatedTs.toLocalDateTime());&#10;            }&#10;        } catch (SQLException ignored) {}&#10;&#10;        return pesanan;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.trying3.dao;&#10;&#10;import com.example.trying3.config.DatabaseConnection;&#10;import com.example.trying3.model.Pesanan;&#10;import com.example.trying3.model.User;&#10;&#10;import java.sql.*;&#10;import java.text.NumberFormat;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;import java.util.Locale;&#10;&#10;/**&#10; * Data Access Object untuk statistik Dashboard.&#10; * Menyediakan berbagai metrik dan data untuk dashboard admin.&#10; */&#10;public class DashboardStatsDAO {&#10;&#10;    public int getTotalPesanan() {&#10;        String sql = &quot;SELECT COUNT(*) FROM pesanan&quot;;&#10;        return executeCountQuery(sql);&#10;    }&#10;&#10;    public int getPesananSelesai() {&#10;        String sql = &quot;&quot;&quot;&#10;            SELECT COUNT(*) FROM pesanan p&#10;            JOIN status_pesanan sp ON p.id_status = sp.id_status&#10;            WHERE sp.nama_status = 'Selesai'&#10;        &quot;&quot;&quot;;&#10;        return executeCountQuery(sql);&#10;    }&#10;&#10;    public String getPersentasePesananSelesai() {&#10;        int total = getTotalPesanan();&#10;        int selesai = getPesananSelesai();&#10;        if (total == 0) return &quot;0%&quot;;&#10;        int persen = (selesai * 100) / total;&#10;        return persen + &quot;% dari total&quot;;&#10;    }&#10;&#10;    public int getPembayaranPending() {&#10;        String sql = &quot;&quot;&quot;&#10;            SELECT COUNT(*) FROM pesanan p&#10;            JOIN status_pesanan sp ON p.id_status = sp.id_status&#10;            WHERE sp.nama_status = 'Menunggu Pembayaran'&#10;        &quot;&quot;&quot;;&#10;        return executeCountQuery(sql);&#10;    }&#10;&#10;    public double getTotalPendapatan() {&#10;        String sql = &quot;SELECT COALESCE(SUM(jumlah), 0) FROM pembayaran WHERE status_pembayaran = 'verified'&quot;;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#10;             ResultSet rs = ps.executeQuery()) {&#10;            if (rs.next()) {&#10;                return rs.getDouble(1);&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return 0;&#10;    }&#10;&#10;    public String getFormattedTotalPendapatan() {&#10;        double total = getTotalPendapatan();&#10;        NumberFormat formatter = NumberFormat.getCurrencyInstance(new Locale(&quot;id&quot;, &quot;ID&quot;));&#10;        String formatted = formatter.format(total);&#10;        return formatted.replace(&quot;,00&quot;, &quot;&quot;).replace(&quot;Rp&quot;, &quot;Rp &quot;);&#10;    }&#10;&#10;    public static class DashboardStats {&#13;&#10;        public int pesananHariIni;&#13;&#10;        public int pesananMingguIni;&#13;&#10;        public int pesananSelesai;&#13;&#10;        public int pembayaranPending;&#13;&#10;        public double pendapatanBulanIni;&#13;&#10;        public int produksiBerjalan;&#13;&#10;        public int kendalaAktif;&#13;&#10;    }&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Mengambil semua statistik sekaligus dari view v_dashboard_stats&#13;&#10;     */&#13;&#10;    public DashboardStats getAllStats() {&#13;&#10;        String sql = &quot;SELECT * FROM v_dashboard_stats&quot;;&#13;&#10;        DashboardStats stats = new DashboardStats();&#13;&#10;&#13;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#13;&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#13;&#10;             ResultSet rs = ps.executeQuery()) {&#13;&#10;&#13;&#10;            if (rs.next()) {&#13;&#10;                stats.pesananHariIni = rs.getInt(&quot;pesanan_hari_ini&quot;);&#13;&#10;                stats.pesananMingguIni = rs.getInt(&quot;pesanan_minggu_ini&quot;);&#13;&#10;                stats.pesananSelesai = rs.getInt(&quot;pesanan_selesai&quot;);&#13;&#10;                stats.pembayaranPending = rs.getInt(&quot;pembayaran_pending&quot;);&#13;&#10;                stats.pendapatanBulanIni = rs.getDouble(&quot;pendapatan_bulan_ini&quot;);&#13;&#10;                stats.produksiBerjalan = rs.getInt(&quot;produksi_berjalan&quot;);&#13;&#10;                stats.kendalaAktif = rs.getInt(&quot;kendala_aktif&quot;);&#13;&#10;            }&#13;&#10;        } catch (SQLException e) {&#13;&#10;            e.printStackTrace();&#13;&#10;        }&#13;&#10;        return stats;&#13;&#10;    }&#13;&#10;&#13;&#10;    // Pesanan Terbaru&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Mengambil pesanan terbaru dengan limit tertentu&#13;&#10;     * Data sudah di-join dengan pelanggan, status, dan detail pesanan&#13;&#10;     */&#13;&#10;    public List&lt;Pesanan&gt; getPesananTerbaru(int limit) {&#13;&#10;        List&lt;Pesanan&gt; list = new ArrayList&lt;&gt;();&#13;&#10;        String sql = &quot;&quot;&quot;&#13;&#10;            SELECT &#13;&#10;                p.id_pesanan,&#13;&#10;                p.nomor_pesanan,&#13;&#10;                pl.nama AS nama_pelanggan,&#13;&#10;                pl.no_telepon,&#13;&#10;                pl.email,&#13;&#10;                jl.nama_layanan,&#13;&#10;                dp.jumlah,&#13;&#10;                p.total_biaya AS total_harga,&#13;&#10;                dp.spesifikasi,&#13;&#10;                sp.nama_status AS status,&#13;&#10;                p.tanggal_pesanan,&#13;&#10;                p.updated_at,&#13;&#10;                p.catatan&#13;&#10;            FROM pesanan p&#13;&#10;            JOIN pelanggan pl ON p.id_pelanggan = pl.id_pelanggan&#13;&#10;            JOIN status_pesanan sp ON p.id_status = sp.id_status&#13;&#10;            LEFT JOIN detail_pesanan dp ON p.id_pesanan = dp.id_pesanan&#13;&#10;            LEFT JOIN jenis_layanan jl ON dp.id_layanan = jl.id_layanan&#13;&#10;            ORDER BY p.tanggal_pesanan DESC&#13;&#10;            LIMIT ?&#13;&#10;        &quot;&quot;&quot;;&#13;&#10;&#13;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#13;&#10;             PreparedStatement ps = conn.prepareStatement(sql)) {&#13;&#10;&#13;&#10;            ps.setInt(1, limit);&#13;&#10;&#13;&#10;            try (ResultSet rs = ps.executeQuery()) {&#13;&#10;                while (rs.next()) {&#13;&#10;                    Pesanan pesanan = mapResultSetToPesanan(rs);&#13;&#10;                    list.add(pesanan);&#13;&#10;                }&#13;&#10;            }&#13;&#10;        } catch (SQLException e) {&#13;&#10;            e.printStackTrace();&#13;&#10;        }&#13;&#10;        return list;&#13;&#10;    }&#13;&#10;&#13;&#10;&#13;&#10;    // Aktivitas User Terbaru&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Mengambil daftar user aktif dengan role-nya&#13;&#10;     * Untuk ditampilkan di section &quot;Aktivitas User&quot;&#13;&#10;     */&#13;&#10;    public List&lt;User&gt; getActiveUsers() {&#13;&#10;        List&lt;User&gt; list = new ArrayList&lt;&gt;();&#13;&#10;        String sql = &quot;&quot;&quot;&#13;&#10;            SELECT &#13;&#10;                u.id_user,&#13;&#10;                u.username,&#13;&#10;                u.nama_lengkap,&#13;&#10;                u.email,&#13;&#10;                u.id_role,&#13;&#10;                r.nama_role,&#13;&#10;                u.is_active,&#13;&#10;                u.last_login,&#13;&#10;                u.created_at,&#13;&#10;                u.updated_at&#13;&#10;            FROM user u&#13;&#10;            JOIN role r ON u.id_role = r.id_role&#13;&#10;            WHERE u.is_active = 1&#13;&#10;            ORDER BY u.last_login DESC&#13;&#10;        &quot;&quot;&quot;;&#13;&#10;&#13;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#13;&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#13;&#10;             ResultSet rs = ps.executeQuery()) {&#13;&#10;&#13;&#10;            while (rs.next()) {&#13;&#10;                User user = new User();&#13;&#10;                user.setIdUser(rs.getInt(&quot;id_user&quot;));&#13;&#10;                user.setUsername(rs.getString(&quot;username&quot;));&#13;&#10;                user.setNamaLengkap(rs.getString(&quot;nama_lengkap&quot;));&#13;&#10;                user.setEmail(rs.getString(&quot;email&quot;));&#13;&#10;                user.setIdRole(rs.getInt(&quot;id_role&quot;));&#13;&#10;                user.setActive(rs.getBoolean(&quot;is_active&quot;));&#13;&#10;&#13;&#10;                Timestamp lastLogin = rs.getTimestamp(&quot;last_login&quot;);&#13;&#10;                if (lastLogin != null) {&#13;&#10;                    user.setLastLogin(lastLogin.toLocalDateTime());&#13;&#10;                }&#13;&#10;&#13;&#10;                Timestamp createdAt = rs.getTimestamp(&quot;created_at&quot;);&#13;&#10;                if (createdAt != null) {&#13;&#10;                    user.setCreatedAt(createdAt.toLocalDateTime());&#13;&#10;                }&#13;&#10;&#13;&#10;                list.add(user);&#13;&#10;            }&#13;&#10;        } catch (SQLException e) {&#13;&#10;            e.printStackTrace();&#13;&#10;        }&#13;&#10;        return list;&#13;&#10;    }&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Mendapatkan nama role berdasarkan id_role&#13;&#10;     */&#13;&#10;    public String getRoleName(int idRole) {&#13;&#10;        String sql = &quot;SELECT nama_role FROM role WHERE id_role = ?&quot;;&#13;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#13;&#10;             PreparedStatement ps = conn.prepareStatement(sql)) {&#13;&#10;            ps.setInt(1, idRole);&#13;&#10;            try (ResultSet rs = ps.executeQuery()) {&#13;&#10;                if (rs.next()) {&#13;&#10;                    return rs.getString(&quot;nama_role&quot;);&#13;&#10;                }&#13;&#10;            }&#13;&#10;        } catch (SQLException e) {&#13;&#10;            e.printStackTrace();&#13;&#10;        }&#13;&#10;        return &quot;Unknown&quot;;&#13;&#10;    }&#13;&#10;&#13;&#10;    // Helper Methods&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Helper untuk menjalankan query COUNT&#13;&#10;     */&#13;&#10;    private int executeCountQuery(String sql) {&#13;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#13;&#10;             PreparedStatement ps = conn.prepareStatement(sql);&#13;&#10;             ResultSet rs = ps.executeQuery()) {&#13;&#10;            if (rs.next()) {&#13;&#10;                return rs.getInt(1);&#13;&#10;            }&#13;&#10;        } catch (SQLException e) {&#13;&#10;            e.printStackTrace();&#13;&#10;        }&#13;&#10;        return 0;&#13;&#10;    }&#13;&#10;&#13;&#10;    /**&#13;&#10;     * Mapping ResultSet ke object Pesanan&#13;&#10;     */&#13;&#10;    private Pesanan mapResultSetToPesanan(ResultSet rs) throws SQLException {&#13;&#10;        Pesanan pesanan = new Pesanan();&#13;&#10;        pesanan.setIdPesanan(rs.getInt(&quot;id_pesanan&quot;));&#13;&#10;        pesanan.setNomorPesanan(rs.getString(&quot;nomor_pesanan&quot;));&#13;&#10;        pesanan.setNamaPelanggan(rs.getString(&quot;nama_pelanggan&quot;));&#13;&#10;&#13;&#10;        try { pesanan.setNoTelepon(rs.getString(&quot;no_telepon&quot;)); } catch (SQLException ignored) {}&#13;&#10;        try { pesanan.setEmail(rs.getString(&quot;email&quot;)); } catch (SQLException ignored) {}&#13;&#10;&#13;&#10;        pesanan.setJenisLayanan(rs.getString(&quot;nama_layanan&quot;));&#13;&#10;        pesanan.setJumlah(rs.getInt(&quot;jumlah&quot;));&#13;&#10;        pesanan.setTotalBiaya(rs.getDouble(&quot;total_harga&quot;));&#13;&#10;&#13;&#10;        try { pesanan.setSpesifikasi(rs.getString(&quot;spesifikasi&quot;)); } catch (SQLException ignored) {}&#13;&#10;&#13;&#10;        pesanan.setStatus(rs.getString(&quot;status&quot;));&#13;&#10;&#13;&#10;        try { pesanan.setCatatan(rs.getString(&quot;catatan&quot;)); } catch (SQLException ignored) {}&#13;&#10;&#13;&#10;        Timestamp tanggalTs = rs.getTimestamp(&quot;tanggal_pesanan&quot;);&#13;&#10;        if (tanggalTs != null) {&#13;&#10;            pesanan.setTanggalPesanan(tanggalTs.toLocalDateTime());&#13;&#10;        }&#13;&#10;&#13;&#10;        try {&#13;&#10;            Timestamp updatedTs = rs.getTimestamp(&quot;updated_at&quot;);&#13;&#10;            if (updatedTs != null) {&#13;&#10;                pesanan.setUpdatedAt(updatedTs.toLocalDateTime());&#13;&#10;            }&#13;&#10;        } catch (SQLException ignored) {}&#13;&#10;&#13;&#10;        return pesanan;&#13;&#10;    }&#13;&#10;}&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/trying3/dao/PelangganDAO.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/trying3/dao/PelangganDAO.java" />
              <option name="originalContent" value="package com.example.trying3.dao;&#10;&#10;import com.example.trying3.config.DatabaseConnection;&#10;import java.sql.*;&#10;import java.util.*;&#10;&#10;/**&#10; * Data Access Object untuk Pelanggan.&#10; * Mengelola operasi CRUD dan ekspor data pelanggan.&#10; */&#10;public class PelangganDAO {&#10;    public List&lt;Map&lt;String, String&gt;&gt; getAllPelangganForExport() {&#10;        List&lt;Map&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT nama, email, no_telepon, alamat FROM pelanggan&quot;;&#10;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             Statement st = conn.createStatement();&#10;             ResultSet rs = st.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                Map&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;Nama&quot;, rs.getString(&quot;nama&quot;));&#10;                map.put(&quot;Email&quot;, rs.getString(&quot;email&quot;));&#10;                map.put(&quot;Telepon&quot;, rs.getString(&quot;no_telepon&quot;));&#10;                map.put(&quot;Alamat&quot;, rs.getString(&quot;alamat&quot;));&#10;                list.add(map);&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return list;&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.trying3.dao;&#10;&#10;import com.example.trying3.config.DatabaseConnection;&#10;import java.sql.*;&#10;import java.util.*;&#10;&#10;/**&#10; * Data Access Object untuk Pelanggan.&#10; * Mengelola operasi CRUD dan ekspor data pelanggan.&#10; */&#10;public class PelangganDAO {&#10;    public List&lt;Map&lt;String, String&gt;&gt; getAllPelangganForExport() {&#10;        List&lt;Map&lt;String, String&gt;&gt; list = new ArrayList&lt;&gt;();&#10;        String sql = &quot;SELECT nama, email, no_telepon, alamat FROM pelanggan&quot;;&#10;&#10;        try (Connection conn = DatabaseConnection.getConnection();&#10;             Statement st = conn.createStatement();&#10;             ResultSet rs = st.executeQuery(sql)) {&#10;&#10;            while (rs.next()) {&#10;                Map&lt;String, String&gt; map = new HashMap&lt;&gt;();&#10;                map.put(&quot;Nama&quot;, rs.getString(&quot;nama&quot;));&#10;                map.put(&quot;Email&quot;, rs.getString(&quot;email&quot;));&#10;                map.put(&quot;Telepon&quot;, rs.getString(&quot;no_telepon&quot;));&#10;                map.put(&quot;Alamat&quot;, rs.getString(&quot;alamat&quot;));&#10;                list.add(map);&#10;            }&#10;        } catch (SQLException e) {&#10;            e.printStackTrace();&#10;        }&#10;        return list;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/trying3/model/User.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/trying3/model/User.java" />
              <option name="originalContent" value="package com.example.trying3.model;&#10;&#10;import java.time.LocalDateTime;&#10;&#10;/**&#10; * Model untuk User/Pengguna sistem.&#10; * Menyimpan informasi user, credentials, dan security features.&#10; */&#10;public class User {&#10;    private int idUser;&#10;    private String username;&#10;    private String passwordHash;&#10;    private String namaLengkap;&#10;    private String email;&#10;    private int idRole;&#10;    private boolean isActive;&#10;    private LocalDateTime lastLogin;&#10;    private int failedLoginAttempts;&#10;    private LocalDateTime lockedUntil;&#10;    private LocalDateTime createdAt;&#10;    private LocalDateTime updatedAt;&#10;&#10;    public User() {}&#10;&#10;    public User(int idUser, String username, String namaLengkap, String email,&#10;                int idRole, boolean isActive) {&#10;        this.idUser = idUser;&#10;        this.username = username;&#10;        this.namaLengkap = namaLengkap;&#10;        this.email = email;&#10;        this.idRole = idRole;&#10;        this.isActive = isActive;&#10;    }&#10;&#10;    // ...existing code...&#10;    public int getIdUser() { return idUser; }&#10;    public void setIdUser(int idUser) { this.idUser = idUser; }&#10;&#10;    public String getUsername() { return username; }&#10;    public void setUsername(String username) { this.username = username; }&#10;&#10;    public String getPasswordHash() { return passwordHash; }&#10;    public void setPasswordHash(String passwordHash) { this.passwordHash = passwordHash; }&#10;&#10;    public String getNamaLengkap() { return namaLengkap; }&#10;    public void setNamaLengkap(String namaLengkap) { this.namaLengkap = namaLengkap; }&#10;&#10;    public String getEmail() { return email; }&#10;    public void setEmail(String email) { this.email = email; }&#10;&#10;    public int getIdRole() { return idRole; }&#10;    public void setIdRole(int idRole) { this.idRole = idRole; }&#10;&#10;    public boolean isActive() { return isActive; }&#10;    public void setActive(boolean active) { isActive = active; }&#10;&#10;    public LocalDateTime getLastLogin() { return lastLogin; }&#10;    public void setLastLogin(LocalDateTime lastLogin) { this.lastLogin = lastLogin; }&#10;&#10;    public int getFailedLoginAttempts() { return failedLoginAttempts; }&#10;    public void setFailedLoginAttempts(int failedLoginAttempts) {&#10;        this.failedLoginAttempts = failedLoginAttempts;&#10;    }&#10;&#10;    public LocalDateTime getLockedUntil() { return lockedUntil; }&#10;    public void setLockedUntil(LocalDateTime lockedUntil) { this.lockedUntil = lockedUntil; }&#10;&#10;    public LocalDateTime getCreatedAt() { return createdAt; }&#10;    public void setCreatedAt(LocalDateTime createdAt) { this.createdAt = createdAt; }&#10;&#10;    public LocalDateTime getUpdatedAt() { return updatedAt; }&#10;    public void setUpdatedAt(LocalDateTime updatedAt) { this.updatedAt = updatedAt; }&#10;&#10;    /**&#10;     * Cek apakah akun terkunci berdasarkan waktu locked_until.&#10;     */&#10;    public boolean isLocked() {&#10;        if (lockedUntil == null) return false;&#10;        return LocalDateTime.now().isBefore(lockedUntil);&#10;    }&#10;&#10;    /**&#10;     * Increment failed attempts dan lock akun jika mencapai 5 kali gagal.&#10;     */&#10;    public void incrementFailedAttempts() {&#10;        this.failedLoginAttempts++;&#10;        if (this.failedLoginAttempts &gt;= 5) {&#10;            this.lockedUntil = LocalDateTime.now().plusMinutes(30);&#10;        }&#10;    }&#10;&#10;    public void resetFailedAttempts() {&#10;        this.failedLoginAttempts = 0;&#10;        this.lockedUntil = null;&#10;    }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;User{&quot; +&#10;                &quot;id=&quot; + idUser +&#10;                &quot;, username='&quot; + username + '\'' +&#10;                &quot;, namaLengkap='&quot; + namaLengkap + '\'' +&#10;                &quot;, email='&quot; + email + '\'' +&#10;                &quot;, role=&quot; + idRole +&#10;                &quot;, active=&quot; + isActive +&#10;                '}';&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.trying3.model;&#10;&#10;import java.time.LocalDateTime;&#10;&#10;/**&#10; * Model untuk User/Pengguna sistem.&#10; * Menyimpan informasi user, credentials, dan security features.&#10; */&#10;public class User {&#10;    private int idUser;&#10;    private String username;&#10;    private String passwordHash;&#10;    private String namaLengkap;&#10;    private String email;&#10;    private int idRole;&#10;    private boolean isActive;&#10;    private LocalDateTime lastLogin;&#10;    private int failedLoginAttempts;&#10;    private LocalDateTime lockedUntil;&#10;    private LocalDateTime createdAt;&#10;    private LocalDateTime updatedAt;&#10;&#10;    public User() {}&#10;&#10;    public User(int idUser, String username, String namaLengkap, String email,&#10;                int idRole, boolean isActive) {&#10;        this.idUser = idUser;&#10;        this.username = username;&#10;        this.namaLengkap = namaLengkap;&#10;        this.email = email;&#10;        this.idRole = idRole;&#10;        this.isActive = isActive;&#10;    }&#10;&#10;    // ...existing code...&#10;    public int getIdUser() { return idUser; }&#10;    public void setIdUser(int idUser) { this.idUser = idUser; }&#10;&#10;    public String getUsername() { return username; }&#10;    public void setUsername(String username) { this.username = username; }&#10;&#10;    public String getPasswordHash() { return passwordHash; }&#10;    public void setPasswordHash(String passwordHash) { this.passwordHash = passwordHash; }&#10;&#10;    public String getNamaLengkap() { return namaLengkap; }&#10;    public void setNamaLengkap(String namaLengkap) { this.namaLengkap = namaLengkap; }&#10;&#10;    public String getEmail() { return email; }&#10;    public void setEmail(String email) { this.email = email; }&#10;&#10;    public int getIdRole() { return idRole; }&#10;    public void setIdRole(int idRole) { this.idRole = idRole; }&#10;&#10;    public boolean isActive() { return isActive; }&#10;    public void setActive(boolean active) { isActive = active; }&#10;&#10;    public LocalDateTime getLastLogin() { return lastLogin; }&#10;    public void setLastLogin(LocalDateTime lastLogin) { this.lastLogin = lastLogin; }&#10;&#10;    public int getFailedLoginAttempts() { return failedLoginAttempts; }&#10;    public void setFailedLoginAttempts(int failedLoginAttempts) {&#10;        this.failedLoginAttempts = failedLoginAttempts;&#10;    }&#10;&#10;    public LocalDateTime getLockedUntil() { return lockedUntil; }&#10;    public void setLockedUntil(LocalDateTime lockedUntil) { this.lockedUntil = lockedUntil; }&#10;&#10;    public LocalDateTime getCreatedAt() { return createdAt; }&#10;    public void setCreatedAt(LocalDateTime createdAt) { this.createdAt = createdAt; }&#10;&#10;    public LocalDateTime getUpdatedAt() { return updatedAt; }&#10;    public void setUpdatedAt(LocalDateTime updatedAt) { this.updatedAt = updatedAt; }&#10;&#10;    /**&#10;     * Cek apakah akun terkunci berdasarkan waktu locked_until.&#10;     */&#10;    public boolean isLocked() {&#10;        if (lockedUntil == null) return false;&#10;        return LocalDateTime.now().isBefore(lockedUntil);&#10;    }&#10;&#10;    /**&#10;     * Increment failed attempts dan lock akun jika mencapai 5 kali gagal.&#10;     */&#10;    public void incrementFailedAttempts() {&#10;        this.failedLoginAttempts++;&#10;        if (this.failedLoginAttempts &gt;= 5) {&#10;            this.lockedUntil = LocalDateTime.now().plusMinutes(30);&#10;        }&#10;    }&#10;&#10;    public void resetFailedAttempts() {&#10;        this.failedLoginAttempts = 0;&#10;        this.lockedUntil = null;&#10;    }&#10;&#10;    @Override&#10;    public String toString() {&#10;        return &quot;User{&quot; +&#10;                &quot;id=&quot; + idUser +&#10;                &quot;, username='&quot; + username + '\'' +&#10;                &quot;, namaLengkap='&quot; + namaLengkap + '\'' +&#10;                &quot;, email='&quot; + email + '\'' +&#10;                &quot;, role=&quot; + idRole +&#10;                &quot;, active=&quot; + isActive +&#10;                '}';&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>